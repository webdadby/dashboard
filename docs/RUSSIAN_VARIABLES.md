# Документация по переменным системы

В этом документе описаны все переменные и настройки, используемые в системе управления отпусками и заработной платой.

## Настройки отпусков (vacation_settings)

| Название переменной | Тип | Описание | Значение по умолчанию |
|---------------------|------|------------------------------------------------|----------------------|
| days_per_year | INTEGER | Количество дней отпуска в году | 24 |
| calculation_period_months | INTEGER | Период в месяцах для расчета средней зарплаты | 12 |
| coefficient | DECIMAL(5,2) | Коэффициент для расчета отпускных | 1.00 |
| min_days_per_request | INTEGER | Минимальное количество дней в одном запросе на отпуск | 7 |
| max_consecutive_days | INTEGER | Максимальное количество последовательных дней отпуска | 28 |

## Баланс отпусков (vacation_balances)

| Название переменной | Тип | Описание |
|---------------------|------|--------------------------------------------|
| employee_id | INTEGER | ID сотрудника |
| year | INTEGER | Год, за который учитывается баланс |
| days_entitled | INTEGER | Количество положенных дней за год |
| days_used | INTEGER | Количество использованных дней |
| days_scheduled | INTEGER | Количество запланированных, но еще не использованных дней |
| days_remaining | INTEGER | Остаток дней (days_entitled - days_used - days_scheduled) |

## Запросы на отпуск (vacation_requests)

| Название переменной | Тип | Описание |
|---------------------|------|--------------------------------------------|
| employee_id | INTEGER | ID сотрудника |
| start_date | DATE | Дата начала отпуска |
| end_date | DATE | Дата окончания отпуска |
| days_count | INTEGER | Количество рабочих дней в периоде отпуска |
| status | VARCHAR(20) | Статус запроса (pending, approved, rejected, completed) |
| payment_amount | DECIMAL(12,2) | Рассчитанная сумма отпускных |
| average_salary | DECIMAL(12,2) | Средняя зарплата, использованная для расчета |
| calculation_period_start | DATE | Начало периода для расчета средней зарплаты |
| calculation_period_end | DATE | Конец периода для расчета средней зарплаты |
| notes | TEXT | Примечания к заявке |

## Настройки рабочего времени (work_norms)

| Название переменной | Тип | Описание |
|---------------------|------|--------------------------------------------|
| working_days | INTEGER | Количество рабочих дней в месяце |
| holiday_days | INTEGER | Количество праздничных дней, выпадающих на рабочие дни |

## Настройки налогов и отчислений (settings)

| Название переменной | Тип | Описание | Значение по умолчанию |
|---------------------|------|--------------------------------------------|----------------------|
| fszn_rate | DECIMAL(5,2) | Ставка отчислений в ФСЗН (%) | 34.00 |
| insurance_rate | DECIMAL(5,2) | Ставка страховых отчислений (%) | 0.60 |

## Расчет заработной платы (payrolls)

| Название переменной | Тип | Описание |
|---------------------|------|--------------------------------------------|
| fszn_tax | DECIMAL(10,2) | Налог ФСЗН (процент от начисленной суммы) |
| insurance_tax | DECIMAL(10,2) | Страховые отчисления (процент от начисленной суммы) |
| total_employee_cost | DECIMAL(10,2) | Общая стоимость сотрудника (к выплате + налоги работодателя) |
| payable_without_salary | DECIMAL(10,2) | Сумма к выплате без учета базового оклада (премии + надбавки - удержания) |

## Формулы и расчеты

### Расчет накопленных дней отпуска
```
Дней_за_месяц = days_per_year / 12
Полные_месяцы = Количество полных месяцев с даты приема
Дней_за_частичный_месяц = (Количество_дней_в_частичном_месяце / Всего_дней_в_месяце) * Дней_за_месяц
Всего_дней = (Полные_месяцы * Дней_за_месяц) + Дней_за_частичный_месяц
```

### Расчет отпускных
```
Отпускные = (Средняя_зарплата / 30) * Количество_дней * Коэффициент
```

### Расчет налогов
```
Налог_ФСЗН = Начисленная_сумма * (fszn_rate / 100)
Страховые_взносы = Начисленная_сумма * (insurance_rate / 100)
```
Таблица: employees

base_salary - Оклад

rate - Cтавка на которую устроен сотрудник

Таблица payrolls

vacation_pay_current - Отпуск. тек." (Current month vacation pay)
vacation_pay_next - Отпуск. след." (Next month vacation pay)
sick_pay - Больничный" (Sick leave payment)